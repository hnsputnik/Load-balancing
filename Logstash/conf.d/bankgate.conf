filter{
  if [type] == "bankgate" {
    grok {
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.*\| %{WORD:msgtype} *%{WORD:msgsource}.*<BANKNOSTRO>%{NUMBER:BANKNOSTRO}<\/BANKNOSTRO><REMARK>(?<REMARK>.*)<\/REMARK><CACCOUNT>%{NUMBER:CACCOUNT}</CACCOUNT><CAMOUNT>%{NUMBER:CAMOUNT}<\/CAMOUNT><CNAME>(?<CNAME>.*)<\/CNAME><SACCOUNT>%{NUMBER:SACCOUNT}<\/SACCOUNT><SID>%{WORD:SID}<\/SID><SNAME>(?<SNAME>.*)<\/SNAME>.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.*\| %{WORD:msgtype} *%{WORD:msgsource}.*<AMOUNT>%{NUMBER:AMOUNT}<\/AMOUNT><AREACODE>%{WORD:AREACODE}<\/AREACODE><CREDITACCOUNT>%{NUMBER:CREDITACCOUNT}<\/CREDITACCOUNT><DATE>%{NUMBER:DATE}<\/DATE><NAME>(?<NAME>.*)</NAME>.*<PROVIDER>%{WORD:PROVIDER}<\/PROVIDER><REFNO>%{WORD:REFNO}<\/REFNO><REMARK>(?<REMARK>.*)<\/REMARK>.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.%{WORD:msgtype} \| %{WORD:msgsource}.*<NS2:BANKID>%{NUMBER:BANKID}<\/NS2:BANKID><NS2:BANKNAME>%{WORD:BANKNAME}</NS2:BANKNAME><NS2:BANKNOSTRO>%{NUMBER:BANKNOSTRO}.*<\/NS2:BANKNOSTRO><NS2:PAYMENTTYPE>%{WORD:PAYMENTTYPE}<\/NS2:PAYMENTTYPE><NS2:TRANSACTIONID>%{WORD:TRANSACTIONID}<\/NS2:TRANSACTIONID><NS2:SACCOUNT>%{NUMBER:SACCOUNT}<\/NS2:SACCOUNT><NS2:SNAME>(?<SNAME>.*)<\/NS2:SNAME><NS2:AMOUNT>(?<AMOUNT>.*)<\/NS2:AMOUNT><NS2:DESCRIPTION>(?<TRN_DESC>.*?),.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.*\| %{WORD:msgsource} %{WORD:msgtype} %{WORD:target}.*<BANKNOSTRO>%{NUMBER:BANKNOSTRO}<\/BANKNOSTRO><REMARK>%{WORD:REMARK}<\/REMARK><CACCOUNT>%{NUMBER:CACCOUNT}<\/CACCOUNT><CAMOUNT>%{NUMBER:CAMOUNT}</CAMOUNT><CNAME>(?<CNAME>.*)<\/CNAME><SACCOUNT>%{NUMBER:SACCOUNT}<\/SACCOUNT><SID>%{WORD:SID}<\/SID><SNAME>(?<SNAME>.*)<\/SNAME>.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.%{WORD:msgtype} \| %{WORD:msgsource} %{WORD:target}.*<ACCNAME>(?<accname>.*)<\/ACCNAME><ACCNUM>%{NUMBER:accnum}<\/ACCNUM><BANKCODE>%{NUMBER:bankcode}<\/BANKCODE><BRANCH>%{NUMBER:branch}<\/BRANCH><KEYACCT1>%{NUMBER:SACCOUNT}<\/KEYACCT1><KEYACCT2>(?<SNAME>.*)<\/KEYACCT2><TRNREF>%{WORD:TRN_REF}<\/TRNREF><TRN_AMOUNT>%{NUMBER:TRN_AMOUNT}<\/TRN_AMOUNT><TRN_DESC>(?<TRN_DESC>.*)<\/TRN_DESC><TRN_DT>%{NUMBER:TRN_DATE}<\/TRN_DT><TXNACC>%{NUMBER:TXNACC}<\/TXNACC>.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.*\| %{WORD:msgsource} %{WORD:msgtype}.*<AMOUNT>%{NUMBER:AMOUNT}<\/AMOUNT><BANKID>%{NUMBER:BANKID}<\/BANKID><BANKNAME>(?<BANKNAME>.*)<\/BANKNAME><BANKNOSTRO>%{NUMBER:BANKNOSTRO}<\/BANKNOSTRO><BRANCHID>%{NUMBER:BRANCHID}<\/BRANCHID><CURRENCY>%{WORD:CURRENCY}<\/CURRENCY><CUSTOMERBANKACCOUNT>%{NUMBER:CUSTOMERBANKACCOUNT}<\/CUSTOMERBANKACCOUNT><CUSTOMERBANKNAME>(?<CUSTOMERBANKNAME>.*)</CUSTOMERBANKNAME><DESCRIPTION>(?<TRN_DESC>.*)<\/DESCRIPTION><FEETYPE>%{WORD:FEETYPE}<\/FEETYPE><FULLNAME>(?<FULLNAME>.*)</FULLNAME>.*<TOBANKID>%{NUMBER:TOBANKID}<\/TOBANKID><TOBANKNAME>(?<TOBANKNAME>.*)<\/TOBANKNAME><TOBRANCHID>%{NUMBER:TOBRANCHID}</TOBRANCHID><TRANSCHANNEL>%{WORD:TRANSCHANNEL}<\/TRANSCHANNEL><TRANSDATE>(?<TRANSDATE>\d{2}\/\d{2}\/\d{4})<\/TRANSDATE><TRANSACTIONID>(?<TRANSACTIONID>\d{2}\/\d{2}\/\d{4,})<\/TRANSACTIONID><SACCOUNT>%{NUMBER:SACCOUNT}<\/SACCOUNT><SNAME>(?<SNAME>.*)<\/SNAME>.*" }
      match => { "message" => "\[(?<timestamp>\d{4}-\d{2}-\d{2} %{TIME})\].*\] %{WORD:channel}.%{WORD:msgtype}.*" }
    }
    date {
      match => [ "timestamp" , "YYYY-MM-dd HH:mm:ss,SSS" ]
      target => "@timestamp"
      locale => "en"
      timezone => "Asia/Ho_Chi_Minh"
    }
  }
}
